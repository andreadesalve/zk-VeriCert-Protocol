Comandi da eseguire - Architettura

#Compilare circuito
circom DidProofKeccak.circom --r1cs --wasm --sym --c -l ..\node_modules\
#info about the circuit
snarkjs r1cs info DidProofKeccak.r1cs
# Powers of Tau
snarkjs powersoftau new bn128 19 pot19_0000.ptau -v
snarkjs powersoftau contribute pot19_0000.ptau pot19_0001.ptau --name="First contribution" -v
snarkjs powersoftau prepare phase2 pot19_0001.ptau pot19_final.ptau -v
#Verify Powersoftau
snarkjs powersoftau verify .\pot19_final.ptau

#Create proving and verification key
snarkjs groth16 setup DidProofKeccak.r1cs pot19_final.ptau DidProofKeccak_0000.zkey
snarkjs zkey contribute DidProofKeccak_0000.zkey DidProofKeccak_0001.zkey --name="root contribution" -v
snarkjs zkey beacon DidProofKeccak_0001.zkey circuit_final.zkey 0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f 10 -n="Final Beacon phase2"
                        #Export verification key
snarkjs zkey export verificationkey DidProofKeccak_0001.zkey verification_key.json


#Verify the final zkey
snarkjs zkey verify DidProofKeccak.r1cs pot19_final.ptau circuit_final.zkey

#generate the Solidity code
snarkjs zkey export solidityverifier circuit_final.zkey verifier.sol


#COMANDI SERVER (PROVER)
Retrieve:  DidProofKeccak.wasm, circuit_final.zkey verification_key.json
Optional:  DidProofKeccak.r1cs, DidProofKeccak.sym, pot12_final.ptau

create input.json data SSIOp.getDNSTXTSecret
#compute witness
node generate_witness.js DidProofKeccak.wasm input.json witness.wtns
#Generating a Proof
snarkjs groth16 prove circuit_final.zkey witness.wtns proof.json public.json
#Verifying a Proof
snarkjs groth16 verify verification_key.json public.json proof.json


#COMANDI CLIENT (VERIFIER)
Retrieve:  verification_key.json,
#Local verification
snarkjs groth16 verify verification_key.json public.json proof.json
#On-chain verification (generate the parameters of the call)
snarkjs generatecall
